# Верстка [Pink](https://crydy.github.io/Pink/) (по макету HTML-academy)

## Описание

Адаптивно-резиновая верстка трехстраничного макета с тремя основными брекпоинтами: мобильная, планшетная и десктопная версии. Просмотр живой версии доступен [здесь](https://crydy.github.io/Pink/).

## Используемые технологии и методологии

 - Gulp;
 - LESS;
 - БЭМ (в вольном обращении).

## Структура проекта

- Исходные файлы хранятся в каталоге **src**, где:
  - html-файлы лежат в корне **src**, и написаны нативным синтаксисом (кроме подключения svg-спрайта, которое осуществляется средствами **posthtml-include** через псевдотег ```<include>``` в начале ```<body>```).
  - Каталог **src/less** содержит ряд less-файлов отдельными бэм-блоками, подключаемых через магистральный **style.less**, который впоследствии компилируется в единичный минифицированный **style.min.css**. Доступно быстрое редактирование цветовой гаммы проекта, настройка брекпоинтов (с пробросом через css custom properties в скрипты, которым нужны брекпоинты), отступов центровщика, длительности переходов и др. в файле **/global/variables.less**.
  - Каталог **src/js** содержит скрипты, которые при сборке автоматически собираются в единый минифицированный файл **all.js**, подключеный на всех страницах в конце body.
  - Каталог **/fonts** для подключаемых шрифтов.
- Каталог **/build** (изначально отсутствует) содержит сборку проекта для работы с живым сервером **browserSync**.
- Каталог **/docs** содержит готовую сборку проекта для [просмотра](https://crydy.github.io/Pink/) на GH-Pages.

## Зависимости

Зависимости стандартно прописаны в **package.json**, и устанавливаются по консольной команде ``` $ npm i```, если установлены и корректно работают **node.js** и **nmp**. Для беглого ознакомления **devDependencies** представлены ниже:

    "@babel/core": "^7.4.3",
    "browser-sync": "^2.26.3",
    "gulp": "^4.0.0",
    "gulp-autoprefixer": "^6.0.0",
    "gulp-babel": "^8.0.0-beta.2",
    "gulp-concat": "^2.6.1",
    "gulp-csso": "^3.0.1",
    "gulp-imagemin": "^5.0.3",
    "gulp-less": "^4.0.1",
    "gulp-plumber": "^1.2.1",
    "gulp-postcss": "^8.0.0",
    "gulp-posthtml": "^3.0.4",
    "gulp-rename": "^1.4.0",
    "gulp-rm": "^2.0.0",
    "gulp-terser": "^1.1.7",
    "gulp-webp": "^4.0.1",
    "posthtml-include": "^1.2.0"

## Локальная сборка проекта

Локальная сборка проекта осуществляется по команде ```$ gulp build```, и собирается в каталог **/build** (добавлен в **.gitignore**). По команде происходит:
1. очистка **/build** (если какие-либо файлы существовали);
2. копирование html-файлов (с инлайном содержимого файла **sprite.svg** из папки **/img** в начало body каждого html-файла) в корень **build**;
3. компиляция **style.less** с автоматической расстановкой вендорных префиксов и минификацией в **build/css/style.min.css** (также создается неминифицированный файл style.css в том-же каталоге);
4. объединение и копирование всех скриптов из **/js** в **build/js/all.js** с транспиляцией (**babel**) и минификацией. Кроме **all.js** в ту-же директорию копируются исходные скрипты. Изоляция скриптов осуществлена посредством замыканий в самовызывающихся функциях (IIFE);
5. копирование шрифтов при их наличии;
6. копирование изображений с их оптимизацией и минимизацией (исключая **src/img/sprite.svg**) в директорию **build/img**. Также в **build/img/webp** создаются копии всех изображений для отдачи браузерам, поддерживающим данный формат.
7. очищается каталог **/docs** и в него копируется текущая сборка из **/build** для размещения на GH-Pages.

## Запуск сервера и разработка
Основные команды:
- ```$ gulp``` - команда по умолчанию (также ```$ gulp go```) - запускает живой сервер для разработки (работает с файлами в **/build**) и запускает отслеживание событий файловой системы. Пересобирает файлы соответствующего типа при их изменении, и перезагружает сервер (автоперезагрузка не происходит при изменении/добавлении картинок). ***Важно**: при работе с сервером и прослушкой ФС файлы собираются и обновляются в **/build**, но не обновлюяются в **/docs**. Для того, чтобы в следующий коммит зашла обновленная сборка для GH-Pages, перед коммитом должна быть выполнена полная пересборка проекта (```$ gulp build```), либо команда копирования проекта в **/docs*** (```$ gulp refreshGHP```).
- ```$ gulp refreshGHP``` - команда обновления содержимого каталога **/docs** из **/build** для публикации на GH-Pages. Стоит выполнять перед коммитом для публикации изменений на хостинг.
- ``` $ gulp build``` - полная пересборка проекта в **/build** по алгоритму, описанному выше.

Дополнительные команды:
- ```$ gulp server``` - запуск сервера (**browserSync**).
- ```$ gulp html``` - копирование **html**-файлов (+ инлайн содержимого **sprite.svg**).
- ```$ gulp less``` (```$ gulp css```) - преобразование и сборка **style.less** в **style.min.css**.
- ```$ gulp js``` - преобразование и сборка всех скриптов в **all.js**.
- ```$ gulp img``` - оптимизация и копирование изображений.
- ```$ gulp webp``` - создание **webp**-копий изображений.
- ```$ gulp fonts``` - копирование шрифтов.
- ```$ gulp rmb``` - зачистить **/build**.